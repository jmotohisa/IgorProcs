#include <Strings as Lists>#include <Value Report>#include "wname"Macro MakeSSCReport1(logfile,thePath)	String logfile="test.log",thePath="_New Path_"	Prompt logfile,"Log File Name"	Prompt thePath, "Name of path containing text files", popup PathList("*", ";", "")+"_New Path_"	Silent 1; PauseUpDate		String datafile,str,strtmp,filename,nb,gname,gname0,Wene	Variable index,ref,ngraph,index0	Variable/G g_nband	Variable nband	if (CmpStr(thePath, "_New Path_") == 0)		| user selected new path ?		NewPath/O data			| this brings up dialog and creates or overwrites path		thePath = "data"	endif| open logfile and make notebook	if (strlen(logfile)<=0)		Open /D/R/P=$thePath/T="sGBWTEXT" ref		logfile= S_fileName	endif	print logfile,thePath	str=wname(logfile)	nb = str+"_nb"	gname = str+"_Graph"	Log2Notebook(nb,logfile,thePath)	| load and plot data file and append plot to notebook	index=1	do		index0 = index-1		strtmp = "000"+num2istr(index)		filename = str + "." + strtmp[strlen(strtmp)-3,strlen(strtmp)-1]|		print filename		Open/R/Z/P=$thePath/T="sGBWTEXT" ref as filename		if(V_flag)			break		endif		LoadSSCRes(filename,thePath,1,index0)		Wene = "Wene_" + num2istr(index0)		PlotSSCRes(index0,filename,gname,$Wene[1],1,1)		gname0 = gname + num2istr(index0)		DoUpDate		AppendGraph2Nb(nb,gname0)		index +=1	while(1)| load and plot summary data and append plot to notobook	filename=str+".plt"	nband=g_nband	LoadSummary(fileName,thePath,nband)	DoUpDate	gname0 = gname + num2istr(index)	DoWindow/C $gname0	AppendGraph2Nb(nb,gname0)	ngraph=index+1	DoWindow/F $nbEnd MacroMacro LoadSSCRes(fileName,pathName,freadE,index)	String fileName,pathName="home"	Variable index,freadE=1	Prompt fileName,"File Name"	Prompt pathName,"Path Name"	Prompt freadE, "Read Energy ?", popup, "Yes;No"	Prompt index,"index"	Silent 1; PauseUpDate	Variable/D ref,nband,unitw	Variable index2	String istr,strtmp,Vpot,w1,Wene,buffer		istr="_"+num2istr(index)	if (strlen(fileName)<=0)		Open /D/R/P=$pathName/T="sGBWTEXT" ref		fileName= S_fileName	endif	print fileName		Open /R/P=$pathName/T="TEXT" ref as fileName	FReadLine ref,buffer	nband = str2num(GetStrFromList(buffer,0,"\t"))	unitw = str2num(GetStrFromList(buffer,1,"\t"))	g_nband=nband|	print nband,unitw	if(freadE==1)		Wene = "Wene"+istr		Make/N=(nband+2)/D/O $Wene		FReadLine ref,buffer		$Wene[0] = str2num(GetStrFromList(buffer,0,"\t"))*1000		$Wene[1] = nband|		print $Wene[0]		index2=0		do			strtmp = GetStrFromList(buffer,index2+1,"\t")			$Wene[index2+2] = str2num(strtmp)*1000|			print $Wene[index2+2]			index2+=1		while(index2<nband)	endif		Close ref|	LoadWave/G/D/A/W/Q/L={0,0,0,1,nband+1}/P=$pathName fileName	LoadWave/J/D/A/W/Q/L={0,2,0,1,nband+1}/P=$pathName fileName	if(V_flag==0)		return	endif| rename and scale Potential	Vpot = "Vpot"+istr	Rename $GetStrFromList(S_waveNames,0,";"),$Vpot		SetScale/P x 0,unitw,"m", $Vpot	$Vpot *=1000	SetScale y,0,1,"meV",$Vpot| rename and scale WaveFunction	index2=0	do		w1="wf"+num2istr(index2)+istr		Rename $GetStrFromList(S_waveNames,1+index2,";"),$w1		$w1 *= $w1		SetScale/P x 0,unitw,"nm", $w1		index2 +=1	while(index2<nband)EndMacro LoadAllSSCRes(pathName,freadE)	String fileName,pathName="_New Path_"	Variable index,freadE=2	Prompt thePath, "Name of path containing text files", popup PathList("*", ";", "")+"_New Path_"	Prompt freadE, "Read Energy ?", popup, "Yes;No"	Silent 1; PauseUpDate		String fileName,ftype="TEXT"	Variable index=0		if(CmpStr(pathName, "_New Path_") == 0)		NewPath/O temporaryPath		PathName = "temporaryPath"	endif		do		fileName = IndexedFile($pathName, index,"TEXT")		if(strlen(fileName)==0)			break		endif		LoadSSCRes(fileName,pathName,freadE,index)		index +=1	while(1)		if(Exists("temporaryPath"))		KillPath temporaryPath	endifEndMacro PlotSSCRes(index,cmmt,gname,nband,offsetwf,fplotE)	Variable index,nband=2,offsetwf=1,fplotE=1	String gname="Graph",cmmt=""	Prompt index,"index"	Prompt cmmt,"comment"	Prompt gname,"base graph name"	Prompt nband,"Number of subbands to plot"	Prompt offsetwf,"offset wavefunction ?",popup,"yes;no"	Prompt fplotE,"Plot energy ?",popup,"yes;no"		Silent 1 ; PauseUpdate		Variable index2	String Vpot,w0,wene,istr	String str_ef,str_e1	String str_textbox=""		istr="_"+num2istr(index)	gname = gname + num2istr(index)|| display potential and wavefunction	Vpot = "Vpot" + istr	Display $Vpot	DoWindow/C $gname|	ModifyGraph lSize($w3)=2|	ModifyGraph lStyle($w0)=1|	ModifyGraph rgb($Vpot)=(0,0,0),rgb($w3)=(0,0,0)	index2=0	do		w0 = "wf"+num2istr(index2)+istr		Append/R $w0		ModifyGraph rgb($w0)=(1,16019,65535)		index2 +=1	while(index2 <nband)	ModifyGraph noLabel(right)=2	ModifyGraph axThick(right)=0| display Fermi energy and Quantuized Energy	Wene = "Wene" + istr	if((fplotE == 1) %& (WaveExists($Wene)==1))		GetAxis/Q bottom		SetDrawEnv xcoord= bottom,ycoord= left,linefgc= (16386,65535,16385)		DrawLine V_min,$Wene[0],V_max,$Wene[0]		str_ef = MakeValueReportString($Wene[0],0,0,"meV",1)				str_textbox = cmmt + "\rE\\BF\\M = " + str_ef		index2=0		do			w0="wf"+num2istr(index2)+istr			if(offsetwf == 1)				ModifyGraph offset($w0)={0,$Wene[index2+2]}			endif			SetDrawEnv xcoord= bottom,ycoord= left,linefgc= (1,16019,65535)			DrawLine V_min,$Wene[index2+2],V_max*0.2,$Wene[index2+2]			str_e1 = MakeValueReportString($Wene[index2+2],0,0,"meV",1) ||||||			str_textbox = str_textbox + "\r\\s("+w0+") E\\B" + num2istr(index2) +"\\M ="			str_textbox = str_textbox + str_e1			index2 +=1		while(index2<nband)		Textbox/N=text0/F=0/A=MC/X=26.52/Y=28.30 str_textbox	endifEndMacroMacro OffsetWavefunction(index,factor)	Variable index,factor=1.5	Silent 1 ; PauseUpdate		Variable Left_min,Left_max	Variable Right_min,Right_max	String w0,w1,w2,w3,w4,w5,istr	String str_ef,str_e0,str_e1		istr=num2istr(index)	w0="EF_"+istr	w1="E0_"+istr	w2="E1_"+istr	w3="Vpot_"+istr	w4="wf0_"+istr	w5="wf1_"+istr		GetAxis Left;Left_min=V_min;Left_max=V_max;	Left_max-=Left_min	GetAxis Right;Right_min=V_min;Right_max=V_max;	Right_max-=Right_min		SetAxis Right,Right_min,Right_max*factor	ModifyGraph offset($w4)={0,($w1[0]/Left_max)*Right_max*factor}	ModifyGraph offset($w5)={0,($w2[0]/Left_max)*Right_max*factor}EndMacroMacro Log2Notebook(nb,logfile,pathName)	String nb = "NoteBook0",logfile="test.log",pathName="home"	Prompt nb,"Name of Notebook"		NewNotebook/N=$nb/F=1/V=1/W=(106,101,685,607) 	Notebook $nb defaultTab=36, statusWidth=238, pageMargins={72,72,72,72}	Notebook $nb showRuler=1, rulerUnits=-1, updating={1, 60}	Notebook $nb newRuler=Normal, justification=0, margins={0,0,468}, spacing={0,0,0}, tabs={}, rulerDefaults={"Courier",10,0,(0,0,0)}	OpenNoteBook/R/V=0/N=dummynote/P=$pathName logfile	Notebook dummynote selection={startOfFile,endOfFile}	GetSelection notebook,dummynote,2	Notebook $nb,text=S_selection	DoWindow/K dummynote	|	Notebook $nb picture={$gname, -1, 1}|	Notebook $nb text="\r"End MacroMacro AppendGraph2Nb(nb,gname)	String nb = "NoteBook0",gname="Graph0"	Prompt nb,"Name of Notebook"		Notebook $nb picture={$gname, -1, 1}	Notebook $nb text="\r"End MacroMacro LoadSummary(fileName,pathName,nband)	String fileName,pathName="home"	Variable nband=2	Prompt fileName,"File Name"	Prompt pathName,"Path Name"	Prompt nband,"number of subband"	Silent 1; PauseUpDate	Variable index2,ref	String w1,prm,ns="Nss",ene="Energy",buffer		if (strlen(fileName)<=0)		Open /D/R/P=$pathName/T="sGBWTEXT" ref		fileName= S_fileName	endif	print fileName		Open /R/P=$pathName/T="TEXT" ref as fileName	FReadLine ref,buffer	prm=GetStrFromList(buffer,0,"\t")	Close ref		LoadWave/G/D/A/W/P=$pathName fileName| results order: main parameter, ns, ef, e0,..., ns0,...	Rename $GetStrFromList(S_waveNames,0,";"),$prm	Rename $GetStrFromList(S_waveNames,1,";"),$ns	$ns*=1e-11	Rename $GetStrFromList(S_waveNames,2,";"),$ene	$ene*=1e3	SetScale/P d 0,0,"10^11cm-2", $ns	SetScale/P d 0,0,"meV", $ene	| rename energy	index2=0	do		w1= ene+num2istr(index2)		Rename $GetStrFromList(S_waveNames,3+index2,";"),$w1		$w1*=1000		SetScale/P d 0,0,"meV", $w1		index2 +=1	while(index2<nband)| rename Ns	index2=0	do		w1=ns+num2istr(index2)		Rename $GetStrFromList(S_waveNames,3+nband+index2,";"),$w1		$w1*=1e-11		SetScale/P d 0,0,"10^11cm-2", $w1		index2 +=1	while(index2<nband)		PlotSummary(prm,ns,ene,nband)EndMacro PlotSummary(prm,ns,ene,nband)	String prm="Vg",ns="Ns",ene="Energy"	Variable nband=2	Prompt nband,"Number of subbands to plot"	PauseUpdate; Silent 1		// building window...	Variable index2	String w1,str_textbox1,str_textbox2,str_textbox	Display /W=(229,170,665,559) $ns vs $prm	Append /R $ene vs $prm	ModifyGraph mode=4	ModifyGraph marker($ns)=19	ModifyGraph marker($ene)=5	str_textbox1="\\s("+ns+") N\\Bs\\M"	str_textbox2="\\s("+ene+") E\\BF\\M"		index2=0	do		w1=Ns+num2istr(index2)		str_textbox1=str_textbox1+"\r\\s("+w1+") N\\Bs" +num2istr(index2)+ "\\M"		Append $w1 vs $prm		ModifyGraph mode($w1)=4		ModifyGraph marker($w1)=19		ModifyGraph rgb($w1)=(0,0,65535)		index2 +=1	while(index2<nband)	index2=0	do		w1=ene+num2istr(index2)		str_textbox2=str_textbox2+"\r\\s("+w1+") E\\Bs" +num2istr(index2)+ "\\M"		Append/R $w1 vs $prm		ModifyGraph mode($w1)=4		ModifyGraph marker($w1)=5		ModifyGraph rgb($w1)=(0,0,65535)		index2 +=1	while(index2<nband)		str_textbox= str_textbox1+"\r"+str_textbox2	Textbox/N=text0/F=0/A=MC/X=-37.67/Y=-2.17 str_textbox	Label bottom prm+" (\\U)"	Label left ns+"(\\U)"	Label right ene+" (\\U)"End