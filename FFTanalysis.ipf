#include <Strings as Lists>#include <differentiate XY>#include <XY Pair To Waveform>Macro LoadandCalcMR(fileName,pathName,current)	String fileName,pathName	Variable current=1e-6	Prompt fileName, "Enter filname"	Prompt pathName,"Select path",popup,pathlist("*",";","")	Prompt current,"current"	Silent 1; PauseUpDate	String strB="B"	String strRxx="Rxx"		LoadMRData(fileName,pathName,strB,strRxx)	CalcMR(current,strRxx)	Display $strRxx vs $strBEndMacro FFTanalysis_step1()		Silent 1; PauseUpDate		| calculate second derivative	Sort B,B,Rxx	DifferentiateXY(B,Rxx,"dRdB")	DifferentiateXY(B,dRdB,"d2RdB2")	Make/O/N=(numpnts(B)) invB	invB=1/B	Sort invB,B,Rxx,dRdB,d2RdB2,invB	Display d2RdB2 vs invB	ShowInfo	DoWindow/C d2RdB2_invBEndMacro FFTanalysis_step2()	Silent 1; PauseUpDate		Variable iBstart,iBend	String temp	| interpolate d^2R/dB^2 in the range spcified by the cursors	DoWindow/F d2RdB2_invB	iBstart = hcsr(A)	iBend = hcsr(B)	Duplicate/O/R=(xcsr(A),xcsr(B)) invB invB2	Duplicate/O/R=(xcsr(A),xcsr(B)) d2RdB2 d2RdB22|	Sort invB2,invB2,d2RdB22	XYToWave2(invB2,d2RdB22,"d2RdB2_interp", 512)	Display d2RdB2_interp	sprintf temp,"interpolated between %g to %g (T^-1)",iBstart,iBend	Textbox/C/N=InterpRange/A=LT/X=5/Y=5 temp		Duplicate/O d2RdB2_interp FFTdata	FFT FFTdata	Display FFTdata|	Make/O/N=(numpnts(FFTdata)) FFTdata FFTamp	Duplicate/O FFTdata,FFTamp	FFTamp = r2polar(FFTdata);Redimension/R FFTamp	Display FFTamp	ShowInfoEndFunction LoadMRData(fileName,pathName,strB,strRxx)	String fileName	String pathName	String strRxx	String strB		Silent 1; PauseUpDate		String w0,w1,w2,w3		LoadWave/G/D/A/W/P=$pathName fileName	if(V_flag==0)		return 0	endif		w0 = GetStrFromList(S_waveNames,0,";")	w2 = GetStrFromList(S_waveNames,1,";")	w1 = GetStrFromList(S_waveNames,2,";")	w3 = GetStrFromList(S_waveNames,3,";")		KillWaves $w1,$w3	Sort $w0, $w0,$w2	Rename $w0,$strB	Rename $w2,$strRxxEndFunction CalcMR(current,s)	Variable current	String s	Silent 1; PauseUpDate	Wave/D w=$s		w /= currentEnd