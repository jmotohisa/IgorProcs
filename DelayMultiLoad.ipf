#pragma rtGlobals=1		// Use modern global access method.#include "DataSetOperations"Macro DelayMultiload(thePath,which,extention)	String thePath="_New Path_",which,extention="dat"	Prompt thePath, "Name of path containing text files", popup PathList("*", ";", "")+"_New Path_"	PauseUpdate;Silent 1	String fileName,name,name0	Variable fileIndex=0, gotFile	Variable wnlength,filenum=0	Variable ref,expt	String buffer	Make/N=1/T/O ExpDate; Make/N=2000/D/O Expostime; Make/N=2000/T/O data0	if (CmpStr(which, "") == 0) 	which="T" 	endif		if (CmpStr(extention, "") == 0)	extention="exp"	endif		if (CmpStr(thePath, "_New Path_") == 0)		| user selected new path ?		NewPath/O data			// this brings up dialog and creates or overwrites path		thePath = "data"			endif	do		fileName = IndexedFile($thePath,fileIndex,"."+extention)			| get name of next exp file in path		gotFile = CmpStr(fileName, "")		if (gotFile)			ExpDate=wname(fileName)[0,5]//		+wname(fileName)[1]+wname(fileName)[2]+wname(fileName)[3]+wname(fileName)[4]+wname(fileName)[5]			wnlength = strlen(wname(fileName))			name=which+wname(fileName)[wnlength-2,wnlength-1]+"_"			data0(filenum)=which+wname(fileName)[wnlength-2,wnlength-1]			if (wnlength==9)				name=which+wname(fileName)[wnlength-3,wnlength-1]+"_"				data0(filenum)=which+wname(fileName)[wnlength-2,wnlength-1]			endif//			LoadWave/J/D/W/L={0,1,0,0,0}/N=$name/O/P=$thePath fileName		// load the waves from file//			LoadWave/J/D/W/K=0/L={0,0,1,0,0}/N=Getvalue/O/P=$thePath fileName //			Open /R/P=$thePath/T="sGBWTEXT" ref as fileName//				FReadLine ref,buffer//				FReadLine ref,buffer//				expt = str2num(StringFromList(buffer,0,"\t"))//			Close ref//			LoadWave/J/D/W/K=0/L={0,0,1,0,0}/N=Getvalue/O/P=$thePath fileName 			LoadWave/G/D/W/N=$name/O/P=$thePath fileName		// load the waves from file//			Expostime(filenum)=Getvalue0[0]; filenum+=1; print filenum ; KillWaves  Getvalue0//			Expostime(filenum)=expt			filenum +=1			name0=name+"0" 		endif		fileIndex += 1	while (gotFile)									| until TextFile runs out of files	Redimension/N=(filenum) Expostime,data0	Duplicate/O data0 $"data"+Expdate[1] ; Duplicate/O Expostime $"Times"+Expdate[1]EndMacro