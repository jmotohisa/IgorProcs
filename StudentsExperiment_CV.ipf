#pragma rtGlobals=1		// Use modern global access method.#include <Value Report>//Macro Do_Student_Experiment(diam,seq)//	Variable seq,diam//	prompt seq,"sequence no"//	Prompt diam,"dot diameter (mm)"//	PauseUpdate; Silent 1	//	Do_Student_Experiment_1(seq)//	Do_Student_Experiment_2(seq,diam)//	Do_Student_Experiment_3(seq,diam)//	Do_Student_Experiment_4(seq,diam)	//	Layout/W=(682,85,1183,661) Table_CV(54,118,284,362)/O=2,Graph_prof(306,458,561,713)/O=1/F=0/T//	Append Graph_invC2V(46,458,301,713)/O=1/F=0/T,Graph_CV(294,114,549,369)/O=1/F=0/T//	Textbox/N=text0/A=LB/X=8.30/Y=93.19 "\\Z18Results of CV on Au/n-Si for Students' Experiment"//	Textbox/N=text1/F=0/A=LB/X=83.95/Y=2.31 "\\JR\\Z1299/4/14\rJ. Motohisa"//End MacroMacro Do_Student_Experiment_0(Nc)	Variable Nc=3.4e17 //effective DOS, for Si Nc=2e19 cm^-3	PauseUpdate; Silent 1		Variable/G g_Nc	g_Nc=Nc	if(exists("Voltage")==0)		Make/N=20 Voltage		Edit Voltage	Endif	if(strsearch(WinList("*",";","WIN:2"),"Table_CV",0)<0)		DoWindow/C Table_CV	else		DoWindow/F Table_CV	endifEnd MacroMacro Do_Student_Experiment_1(seq)	Variable seq	PauseUpdate; Silent 1	String tbl0,cap,tbl	tbl0="Table_CV"	cap="Capacitance"+num2istr(seq)	tbl="Table_CV"+num2istr(seq)	Duplicate/O Voltage,$cap	Edit Voltage,$cap	DoWindow/C $tbl		DoWindow/F $tbl0	AppendToTable $capEnd MacroMacro Do_Student_Experiment_2(seq,diam)	Variable seq,diam	prompt seq,"sequence no."	Prompt diam,"dot diameter (mm)"	PauseUpdate; Silent 1	String str0	String cap,tbl,grp	cap="Capacitance"+num2istr(seq)	tbl="Table_CV"+num2istr(seq)	grp="Graph_CV"+num2istr(seq)		Display /W=(532,154,837,482) $cap vs Voltage	DoWindow/C $grp		ModifyGraph mode=4,marker=19	ModifyGraph tick=2,mirror=1,standoff=0	Label left "Capacitance C (\\U)"	Label bottom "Bias Voltage (\\U)"	SetAxis left 0,1.5e-10	SetAxis bottom -1.6,0.1	str0 = "\\[0Au/n-Si\r\\F'Symbol'\\f02F \\]0 =" + MakeValueReportString(diam,0,0,"mm",0)	Textbox/N=text0/F=0/A=MC/X=-27.80/Y=36.46 str0End MacroMacro Do_Student_Experiment_3(seq,diam)	Variable diam,seq	prompt seq,"sequence no."	Prompt diam,"dot diameter (mm)"	PauseUpdate; Silent 1	Variable/D ND,Vbi,psiB,area	String strW0,strW1,str0,str1,str2,str3,str4	String cap,cap2,grp2	area = (diam*diam)*pi/4		cap="Capacitance"+num2istr(seq)	cap2="Capacitance2"+num2istr(seq)	grp2="Graph_invC2V"+num2istr(seq)	Duplicate/O $cap,$cap2	$cap2 = 1/($cap*$cap)	SetScale d 0,0,"", $cap2	Display /W=(246,258,583,580) $cap2 vs Voltage	DoWindow /C $grp2	ModifyGraph mode=4,marker=19	ModifyGraph tick=2,mirror=1,standoff=0	SetAxis bottom -1.6,0.7 	SetAxis left 0,3.5e+20 ;DelayUpdate	Label bottom "Bias Voltage (\\U)"	Label left "1/C\\S2\\M (\\uF\\S-2\\M)";	CurveFit/Q line $cap2 /X=Voltage /D	ND = -2/(area*area*1e-6*1.602e-19*12*8.85e-12*W_coef[1])	Vbi = -W_coef[0]/W_coef[1]	psiB = Vbi + 300*8.62e-5*ln(g_Nc/ND)	strW0 = MakeValueReportString(W_coef[0],W_coef[0]/1000,0,"",1)	strW1 = MakeValueReportString(W_coef[1],W_coef[0]/1000,0,"",1)	str1 = MakeValueReportString(ND,ND/1000,0,"",1)	str2 = MakeValueReportString(Vbi,Vbi/1000,0,"",1)	str3 = MakeValueReportString(psiB,psiB/1000,0,"",1)|	Print str1,str2,str3	str0 = "1/C\S2\M = " + strW0 + "\r                " + strW1 + " V"	str1 = "N\BD\M = " + str1	str2 = "V\\Bbi\\M = " + str2	str3 = "\\[0q\\F'Symbol'F\\]0\\BB\\M =" + str3	str1 = str1 + "\r" + str2 + "\r" + str3	str4 = "\\[0Au/n-Si\r\\F'Symbol'\\f02F \\]0 =" + MakeValueReportString(diam,0,0,"mm",0)	Textbox/N=text0/F=0/A=MC/X=10.59/Y=25.46 str0	Textbox/N=text1/F=0/A=MC/X=-19.22/Y=-23.25 str1	Textbox/N=text2/F=0/A=MC/X=-26.67/Y=40.96  str4End MacroMacro Do_Student_Experiment_4(seq,diam)	Variable/D diam,seq	Prompt seq,"sequence no."	Prompt diam,"dot diameter (mm)"	PauseUpdate; Silent 1		Variable/D area	area = (diam*diam)*pi/4	String cap	cap="Capacitance"+num2istr(seq)		XYtowave2(voltage,$cap,"Cap",32)	CalcProfile("Cap",area,12)	DoWindow/C Graph_prof|	DoWindow /W=(5,42,400,250)	ModifyGraph tick=2,mirror=1,standoff=0	Label bottom "depth (\\U)"	Label left "N\BD\M (\\u m\\S-3\\M)"	SetScale y 0,0,"", Cap_prof	SetAxis left 0,4e+21	SetAxis bottom 0,1e-06	ModifyGraph lblMargin(left)=7End Macro