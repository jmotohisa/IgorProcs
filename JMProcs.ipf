#if IgorVersion() >= 6.20#pragma rtGlobals = 3 // Strict wave reference mode, runtime bounds checking#endif// JMProcs.ipt// Some common funtions//// revision history//		??/??/??	ver 0.01 initial version//		21/08/12 ver 0.02 CopyScale2 is moved from mappingSPEFunction/S XAxisOfWave(gr,wv,instance)	String gr,wv	Variable instance		String info=TraceInfo(gr,wv,instance)	String key=";XAXIS:",nm	nm = GetStrWithKey(info,key,";")	return nmEndFunction YoffsetOfWave(gr,wv,instance)	String gr,wv	Variable instance		Variable yofs	String info=TraceInfo(gr,wv,instance)	String key=";offset(x)=",ofs	ofs = GetStrWithKey(info,key,";")//	print ofs	yofs=GetNumWithKey(ofs,",","}")	return yofsEndFunction/S YAxisOfWave(gr,wv,instance)	String gr,wv	Variable instance		String info=TraceInfo(gr,wv,instance)	String key=";YAXIS:",nm	nm = GetStrWithKey(info,key,";")	return nmEndFunction/S XWaveOfWave(gr,wv,instance)	String gr,wv	Variable instance		String info=TraceInfo(gr,wv,instance)	String key="XWAVE:",nm	nm = GetStrWithKey(info,key,";")	return nmEndFunction GetNumWithKey(str,key1,key2)	String str,key1,key2		Variable,st,en,res	st = strsearch(str,key1,0)	st+=strlen(key1)	en = strsearch(str,key2,st)-strlen(key2)	res=str2num(str[st,en])	return resEndFunction/S GetStrWithKey(str,key1,key2)	String str,key1,key2		Variable,st,en	String res	st = strsearch(str,key1,0)	st+=strlen(key1)	en = strsearch(str,key2,st)-strlen(key2)	res=str[st,en]	return resEnd// Copy scales: dimdest=0,1,2,3 for x, y, z, and tFunction CopyScale2(orig,dimorig,dest,dimdest)	String orig,dest	Variable dimorig,dimdest		Variable x0=DimOffset($orig,dimorig)	Variable dx=DimDelta($orig,dimorig)	String unitStr=WaveUnits($orig,dimorig)		switch(dimdest)		case 1:			SetScale/P y,x0,dx,unitStr,$dest			break		case 2:			SetScale/P z,x0,dx,unitStr,$dest			break		case 3:			SetScale/P t,x0,dx,unitStr,$dest			break		case 0:		default :			SetScale/P x,x0,dx,unitStr,$dest			break	endswitch	SetScale d,0,0,WaveUnits($orig,-1),$destEnd