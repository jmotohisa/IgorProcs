#pragma rtGlobals=1		// Use modern global access method.#include <Value Report>#include <Strings as Lists>#include "wname"Macro InitPhCband()	String/G g_wname="wave"	String/G g_polarization	Variable/G g_latticeType,n_planewave,g_epsa,g_epsb,g_diam,g_filfactorEnd MacroMacro LoadPhCBandResults(thePath,fname)	String thePath="home",fname=""	Prompt fname,"File name"	Prompt thePath,"Path Name"	Silent 1;PauseUpdate		Variable ref	String str,str2	if (strlen(fname)<=0)		Open /D/R/P=$thePath/T="TEXT" ref		fname= S_fileName		print fname	endif	Open/R/P=$thePath ref as fname	FReadLine ref,str	// dummy	FReadLine ref,str	// polaization		g_polarization = str	FreadLine ref,str	// dummy	FreadLine ref,str	// lattice type		g_latticetype = str2num(GetStrFromList(str,1,":"))	FreadLine ref,str	// # of planwave		n_planewave = str2num(GetStrFromList(str,1,"="))	FreadLine ref,str	// eps_a		g_epsa = str2num(GetStrFromList(str,1,"="))	FreadLine ref,str	// eps_b		g_epsb = str2num(GetStrFromList(str,1,"="))	FreadLine ref,str	// size		g_diam = str2num(GetStrFromList(str,1,"="))	FreadLine ref,str	// filling factor		g_filfactor = str2num(GetStrFromList(str,1,"="))	Close ref	print g_polarization,g_latticetype,n_planewave,g_epsa,g_epsb,g_diam,g_filfactor	g_wname = wname(fname)+"b"	LoadWave/G/D/W/Q/A=$g_wname/P=$thePath fnameEnd MacroMacro PhCbandPlot(wvname,nplot)	String wvname=g_wname	Variable nplot=10	Prompt wvname,"wave name to start with"	Prompt nplot,"Number of Plots"	Silent 1;PauseUpdate	Variable index,index0,xmin,xmax	String wn,str_1,str_2,str_3,str_4,str_textbox	display/W=(5,42,441,624)// scaling// Gamma -> J	index=0	index0=2	xmin=0	xmax=4/3	do		wn = wvname+num2str(index0+index)		SetScale/I x ,xmin,xmax,"",$wn		append $wn		index+=1		if(index==nplot)			break		endif	while(1)// Gamma -> X	index0=nplot+4	index=0	xmin = 4/3+2	xmax = 4/3+1	do		wn = wvname+num2str(index0+index)		SetScale/I x ,xmin,xmax,"",$wn		append $wn		index+=1		if(index==nplot)			break		endif	while(1)// J->X	index0=2*nplot+6	index=0	xmin = 4/3	xmax = 4/3+1	do		wn = wvname+num2str(index0+index)		SetScale/I x ,xmin,xmax,"",$wn		append $wn		index+=1		if(index==nplot)			break		endif	while(1)	ModifyGraph margin(top)=85	ModifyGraph tick=2	ModifyGraph mirror=1	ModifyGraph noLabel(bottom)=1	ModifyGraph standoff=0	Label left "\\F'Symbol'w\\F'Helvetica'a/2\\F'Symbol'p\\F'Helvetica'c"	Label bottom "k\\B//\\M"	Textbox/N=text0/F=0/A=MC/X=-49.58/Y=53.74 "\\F'Symbol'G"	Textbox/N=text0_1/F=0/A=MC/X=-9.97/Y=53.96 "J"	Textbox/N=text0_2/F=0/A=MC/X=19.94/Y=54.41 "X"	Textbox/N=text0_3/F=0/A=MC/X=50.14/Y=54.63 "\\F'Symbol'G"	str_1 = MakeValueReportString(g_filfactor,0,0,"",1)	str_2 = MakeValueReportString(g_epsa,0,0,"",1)	str_3 = MakeValueReportString(g_epsb,0,0,"",1)	str_4 = MakeValueReportString(g_diam,0,0,"",1)	if(g_latticetype==1)		str_textbox = "normal lattice\r"	else if (g_latticetype==2)		str_textbox = "orthogonal lattice\r"	else		str_textbox = "circular hole\r"	endif	str_textbox = str_textbox+g_polarization	str_textbox = str_textbox+"a = "+str_4 + "\r"	str_textbox = str_textbox+"f = "+str_1+"\r"	str_textbox = str_textbox+"\\F'Symbol'e\\F'Helvetica'\\Ba\\M = "+str_2+"\r"	str_textbox = str_textbox+"\\F'Symbol'e\\F'Helvetica'\\Bb\\M = "+str_3//	str_textbox = str_textbox+pol+"-polarization"	Textbox/N=text1/F=0/A=MC/X=36.29/Y=-38.33 str_textbox	SetDrawLayer UserFront//	SetDrawEnv xcoord= bottom,ycoord= prel//	DrawLine 0,0,0,1	SetDrawEnv xcoord= bottom,ycoord= prel	DrawLine 1.3333333,0,1.333333,1	SetDrawEnv xcoord= bottom,ycoord= prel	DrawLine 2.3333333,0,2.333333,1		g_wname = wvnameEndMacro PBGdataLoad(thePath,fname)	String thePath="home",fname=""	Prompt fname,"File name"	Prompt thePath,"Path Name"	Silent 1;PauseUpdate		Variable ref	String str,str2	if (strlen(fname)<=0)		Open /D/R/P=$thePath/T="TEXT" ref		fname= S_fileName		print fname	endif	g_wname = "g"+wname(fname)	LoadWave/G/D/W/Q/A=$g_wname/P=$thePath fnameEnd MacroMacro PBGdataLoad2(thePath,fname)	String thePath="home",fname=""	Prompt fname,"File name"	Prompt thePath,"Path Name"	Silent 1;PauseUpdate		Variable ref	String str,str2	if (strlen(fname)<=0)		Open /D/R/P=$thePath/T="TEXT" ref		fname= S_fileName		print fname	endif	g_wname = "g"+wname(fname)	LoadWave/J/D/W/Q/A=$g_wname/P=$thePath fname	KillWaves $(g_wname+"0")	Rename $(g_wname+"1"),$(g_wname+"0")End MacroMacro PBGMapPlot(wvname,nplot,mode)	String wvname=g_wname,	Variable nplot=10,mode=1	Prompt wvname,"wave name to start with"	Prompt nplot,"Number of Plots"	Prompt mode,"horizontal axis",popup,"diameter;FillFactor"	Silent 1;PauseUpdate		Variable index	String xwnm,wn1,wn2,labelbottom	if(mode==1)		xwnm=wvname+"0"		labelbottom="normlized hole size"	else		xwnm=wvname+"1"		labelbottom = "filling fraction"	endif	display/W=(5,42,441,624)	index=3	do		wn1 = wvname+num2str(index)		wn2 = wvname+num2str(index+1)//		print wn1,wn2,xwnm		append $wn1,$wn2 vs $xwnm		ModifyGraph mode($wn1)=7//		ModifyGraph hbFill($wn1)=2		ModifyGraph toMode($wn1)=1		ModifyGraph useNegPat($wn1)=1		ModifyGraph usePlusRGB($wn1)=1		ModifyGraph useNegRGB($wn1)=1		ModifyGraph hBarNegFill($wn1)=2		ModifyGraph rgb=(65535,65535,65535)		index+=2		if((index-1)/2>=nplot)			break		endif	while(1)	ModifyGraph tick=2	ModifyGraph mirror=1//	ModifyGraph noLabel(bottom)=1	ModifyGraph standoff=0	Label left "\\F'Symbol'w\\F'Helvetica'a/2\\F'Symbol'p\\F'Helvetica'c"	Label bottom labelbottomEnd MacroMacro PBGFoMCalc(wvname,nplot,mode)	String wvname=g_wname,	Variable nplot=10,mode=1	Prompt wvname,"wave name to start with"	Prompt nplot,"Number of Plots"	Prompt mode,"horizontal axis",popup,"diameter;FillFactor"	Silent 1;PauseUpdate		Variable index,index2,nn	String xwnm,wn1,wn2,labelbottom,FoMWave	if(mode==1)		xwnm=wvname+"0"		labelbottom="normlized hole size"	else		xwnm=wvname+"1"		labelbottom = "filling fraction"	endif	display/W=(5,42,441,624)	index=3	do		wn1 = wvname+num2str(index)		wn2 = wvname+num2str(index+1)//		print wn1,wn2		FoMWave = wvname+"_fom"+num2str(index)		Duplicate/O $wn1 tempFoMwave1,$FoMWave		Duplicate/O $wn2 tempFoMwave2		$FoMWave=2*(tempFoMwave2- tempFoMwave1)/( tempFoMwave1+ tempFoMwave2)		nn=numpnts($FoMWave)		index2=0		do			if($FoMWave[index2]<0)				$FoMwave[index2] =0			endif			index2+=1			if(index2>nn)				break			endif		while(1)		append $FoMWave vs $xwnm		index+=2		if((index-1)/2==nplot)			break		endif	while(1)	ModifyGraph tick=2	ModifyGraph mirror=1//	ModifyGraph noLabel(bottom)=1	ModifyGraph standoff=0	Label left "Figure of Merit"	Label bottom labelbottomEnd MacroMacro PhCbandPlot1(wvname,nplot,ff,epsa,epsb,pol)	String wvname=g_wname,pol="H"	Variable nplot=10,epsa=1,ff=0.3,epsb=10.88	Prompt wvname,"wave name to start with"	Prompt nplot,"Number of Plots"	Prompt ff,"filling fraction"	Prompt epsa,"Epsilon of hole"	Prompt epsb,"Epsilon of sorrounding material"	Prompt pol,"polarization",popup,"H;E"	Silent 1;PauseUpdate	Variable index,index0,xmin,xmax	String wn,str_1,str_2,str_3,str_textbox	display/W=(5,42,441,624)// scaling// Gamma -> J	index=0	index0=2	xmin=0	xmax=4/3	do		wn = wvname+num2str(index0+index)		SetScale/I x ,xmin,xmax,"",$wn		append $wn		index+=1		if(index==nplot)			break		endif	while(1)// Gamma -> X	index0=nplot+4	index=0	xmin = 0	xmax = -1	do		wn = wvname+num2str(index0+index)		SetScale/I x ,xmin,xmax,"",$wn		append $wn		index+=1		if(index==nplot)			break		endif	while(1)// J->X	index0=2*nplot+6	index=0	xmin = 4/3	xmax = 4/3+1	do		wn = wvname+num2str(index0+index)		SetScale/I x ,xmin,xmax,"",$wn		append $wn		index+=1		if(index==nplot)			break		endif	while(1)	ModifyGraph margin(top)=85	ModifyGraph tick=2	ModifyGraph mirror=1	ModifyGraph noLabel(bottom)=1	ModifyGraph standoff=0	Label left "\\F'Symbol'w\\F'Helvetica'a/2\\F'Symbol'p\\F'Helvetica'c"	Label bottom "k\\B//\\M"	Textbox/N=text0/F=0/A=MC/X=-20.22/Y=54.63 "\\F'Symbol'G"	Textbox/N=text0_1/F=0/A=MC/X=20.22/Y=54.63 "J"	Textbox/N=text0_2/F=0/A=MC/X=-49.31/Y=54.63 "X"	Textbox/N=text0_3/F=0/A=MC/X=50.14/Y=54.63 "X"	str_1 = MakeValueReportString(ff,0,0,"",1)	str_2 = MakeValueReportString(epsa,0,0,"",1)	str_3 = MakeValueReportString(epsb,0,0,"",1)	str_textbox = "f = "+str_1+"\r"	str_textbox = str_textbox+"\\F'Symbol'e\\F'Helvetica'\\Ba\\M = "+str_2+"\r"	str_textbox = str_textbox+"\\F'Symbol'e\\F'Helvetica'\\Bb\\M = "+str_3+"\r"	str_textbox = str_textbox+pol+"-polarization"	Textbox/N=text1/F=0/A=MC/X=36.29/Y=-38.33 str_textbox	SetDrawLayer UserFront	SetDrawEnv xcoord= bottom,ycoord= prel	DrawLine 0,0,0,1	SetDrawEnv xcoord= bottom,ycoord= prel	DrawLine 1.3333333,0,1.333333,1		g_wname = wvnameEndMacro PhCbandPlot2(wvname,nplot,ff,epsa,epsb,pol)	String wvname=g_wname,pol="H"	Variable nplot=10,epsa=1,ff=0.3,epsb=10.88	Prompt wvname,"wave name to start with"	Prompt nplot,"Number of Plots"	Prompt ff,"filling fraction"	Prompt epsa,"Epsilon of hole"	Prompt epsb,"Epsilon of sorrounding material"	Prompt pol,"polarization",popup,"H;E"	Silent 1;PauseUpdate	Variable index,index0,xmin,xmax	String wn,str_1,str_2,str_3,str_textbox	display/W=(5,42,441,624)// scaling// Gamma -> J	index=0	index0=2	xmin=0	xmax=4/3	do		wn = wvname+num2str(index0+index)		SetScale/I x ,xmin,xmax,"",$wn		append $wn		index+=1		if(index==nplot)			break		endif	while(1)// Gamma -> X	index0=nplot+4	index=0	xmin = 4/3+2	xmax = 4/3+1	do		wn = wvname+num2str(index0+index)		SetScale/I x ,xmin,xmax,"",$wn		append $wn		index+=1		if(index==nplot)			break		endif	while(1)// J->X	index0=2*nplot+6	index=0	xmin = 4/3	xmax = 4/3+1	do		wn = wvname+num2str(index0+index)		SetScale/I x ,xmin,xmax,"",$wn		append $wn		index+=1		if(index==nplot)			break		endif	while(1)	ModifyGraph margin(top)=85	ModifyGraph tick=2	ModifyGraph mirror=1	ModifyGraph noLabel(bottom)=1	ModifyGraph standoff=0	Label left "\\F'Symbol'w\\F'Helvetica'a/2\\F'Symbol'p\\F'Helvetica'c"	Label bottom "k\\B//\\M"	Textbox/N=text0/F=0/A=MC/X=-49.58/Y=53.74 "\\F'Symbol'G"	Textbox/N=text0_1/F=0/A=MC/X=-9.97/Y=53.96 "J"	Textbox/N=text0_2/F=0/A=MC/X=19.94/Y=54.41 "X"	Textbox/N=text0_3/F=0/A=MC/X=50.14/Y=54.63 "\\F'Symbol'G"	str_1 = MakeValueReportString(ff,0,0,"",1)	str_2 = MakeValueReportString(epsa,0,0,"",1)	str_3 = MakeValueReportString(epsb,0,0,"",1)	str_textbox = "f = "+str_1+"\r"	str_textbox = str_textbox+"\\F'Symbol'e\\F'Helvetica'\\Ba\\M = "+str_2+"\r"	str_textbox = str_textbox+"\\F'Symbol'e\\F'Helvetica'\\Bb\\M = "+str_3+"\r"	str_textbox = str_textbox+pol+"-polarization"	Textbox/N=text1/F=0/A=MC/X=36.29/Y=-38.33 str_textbox	SetDrawLayer UserFront//	SetDrawEnv xcoord= bottom,ycoord= prel//	DrawLine 0,0,0,1	SetDrawEnv xcoord= bottom,ycoord= prel	DrawLine 1.3333333,0,1.333333,1	SetDrawEnv xcoord= bottom,ycoord= prel	DrawLine 2.3333333,0,2.333333,1		g_wname = wvnameEnd