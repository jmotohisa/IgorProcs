#include <Strings as Lists>| Macro to load PL data taken by VEE programs|      PLtest.vee, PL1-2, etc...|Macro LoadStepperScanData(fileName,pathName,waveName,flag1,flag2)	String fileName, pathName="home", waveName	Variable flag1=1,flag2=1	Prompt flag1,"delete delay time data ?",popup,"yes;no"	Prompt flag2,"delete stepper position data ?",popup,"yes;no"	Silent 1; PauseUpDate	String w0,w1,w2	Variable ref		if (strlen(fileName)<=0)		Open /D/R/P=$pathName/T="sGBWTEXT" ref		fileName= S_fileName	endif		LoadWave/G/D/A/W/P=$pathName fileName	if(V_flag==0)		return	endif		w0 = GetStrFromList(S_waveNames,0,";")	| delay time	w1 = GetStrFromList(S_waveNames,1,";")	| signal	w2 = GetStrFromList(S_waveNames,2,";")	| position	Sort $w0, $w0, $w1,$w2		WaveStats/Q $w0	SetScale/I x,V_min*1e-12,V_max*1e-12,"sec",$w1	if (strlen(waveName)<1)		waveName="S"+wname(fileName)	endif	print waveName	Rename $w1,$waveName		if(flag1 == 1)		KillWaves $w0	else		SetScale/I x,V_min*1e-12,V_max*1e-12,"sec",$w0		Rename $w0,$("T"+waveName)	endif		if(flag2 == 1)		KillWaves $w2	else		SetScale/I x,V_min*1e-12,V_max*1e-12,"sec",$w2		Rename $w2,$("P"+waveName)	endif		Duplicate/O $waveName,dummywave0End MacroMacro MultiStepperScandataLoad(thePath, wantToPrint,flag1,flag2)	String thePath="_New Path_"	Prompt thePath, "Name of path containing text files", popup PathList("*", ";", "")+"_New Path_"	Variable wantToPrint=2	Prompt wantToPrint, "Do you want to print graphs?", popup, "Yes;No"	Variable flag1=1,flag2=1	Prompt flag1,"delete delay time data ?",popup,"yes;no"	Prompt flag2,"delete stepper position data ?",popup,"yes;no"|	String ftype="sGBW"	String ftype="TEXT"	|Prompt ftype,"Filetype"		Silent 1		String fileName	Variable fileIndex=0, gotFile		if (CmpStr(thePath, "_New Path_") == 0)		| user selected new path ?		NewPath/O data			| this brings up dialog and creates or overwrites path		thePath = "data"	endif		DoWindow /F Graphplot							| make sure Graphplot is front window	if (V_flag == 0)								| Graphplot does not exist?		Make/N=2/D/O dummywave0		Graphplot()									| create it	endif		do		fileName = IndexedFile($thePath,fileIndex,ftype)			| get name of next file in path		gotFile = CmpStr(fileName, "")		if (gotFile)			LoadStepperScanData(fileName,thePath,"",flag1,flag2)			|LoadWave/G/P=$thePath/O/N=wave fileName		| load the waves from file			Textbox/C/N=tb_file/F=0/A=MT/X=-30/Y=5 "File: "+fileName			DoUpdate		| make sure graph updated before printing			if (wantToPrint == 1)				PrintGraphs/R Graphplot(2, 2, 98, 98)/F=1	| print graph			endif		endif		fileIndex += 1	while (gotFile)									| until TextFile runs out of filesEndMacroFunction/S wname(name)	string name	variable start,stop,length,tmp=-1	length=strlen(name)	do		start=tmp+1		tmp=strsearch(name,":",start)	while(tmp>-1)	stop=strsearch(name,".",0 )	if (stop<0)		stop=length	endif	return name[start,stop-1]END