#include <Strings as Lists>Macro LoadVgIdData(fileName,pathName,index)	String fileName	String pathName	Variable index		Silent 1; PauseUpDate		String w0,Vg,w2,w3,w4,Id	String w6,w7		LoadWave/G/D/A/W/P=$pathName fileName	if(V_flag==0)		return	endif		w0 = GetStrFromList(S_waveNames,0,";")	Vg = GetStrFromList(S_waveNames,1,";")	w2 = GetStrFromList(S_waveNames,2,";")	w3 = GetStrFromList(S_waveNames,3,";")	w4 = GetStrFromList(S_waveNames,4,";")	Id = GetStrFromList(S_waveNames,5,";")		KillWaves $w0,$w2,$w3,$w4	Sort $Vg, $Vg, $Id	WaveStats $vg	SetScale/I x,V_min,V_max,"V",$Id|	SetScale y,0,1,"I",$Id	KillWaves $Vg	w7 = "Id" + num2istr(index)	Rename $Id,$w7|	Display $w7EndMacro LoadVgIdData1(fileName,pathName,index)	String fileName	String pathName	Variable index		Silent 1; PauseUpDate		String w0,Vg,w2,w3,w4,Id	String w6,w7		LoadWave/G/D/A/W/P=$pathName fileName	if(V_flag==0)		return	endif		w0 = GetStrFromList(S_waveNames,0,";")	Vg = GetStrFromList(S_waveNames,1,";")	Id = GetStrFromList(S_waveNames,5,";")	w2 = GetStrFromList(S_waveNames,2,";")		KillWaves $w0,$w2	Sort $Vg, $Vg, $Id	WaveStats $vg	SetScale/I x,V_min,V_max,"V",$Id|	SetScale y,0,1,"I",$Id	KillWaves $Vg	w7 = "Id" + num2istr(index)	Rename $Id,$w7|	Display $w7EndMacro LoadVgIdData2(fileName,pathName,index)	String fileName	String pathName	Variable index		Silent 1; PauseUpDate		String w0,Vg,w2,w3,w4,Id	String w6,w7		LoadWave/G/D/A/W/P=$pathName fileName	if(V_flag==0)		return	endif		w0 = GetStrFromList(S_waveNames,0,";")	Vg = GetStrFromList(S_waveNames,1,";")	Id = GetStrFromList(S_waveNames,5,";")	w2 = GetStrFromList(S_waveNames,2,";")	w3 = GetStrFromList(S_waveNames,3,";")	w4 = GetStrFromList(S_waveNames,4,";")		KillWaves $w0,$w2,$w3,$w4	Sort $Vg, $Vg, $Id	WaveStats $vg	SetScale/I x,V_min,V_max,"V",$Id|	SetScale y,0,1,"I",$Id	KillWaves $Vg	w7 = "Id" + num2istr(index)	Rename $Id,$w7|	Display $w7EndMacro LoadAllVgIdData2(pathName)	String pathName		Silent 1; PauseUpDate		String fileName	String w0,Vg,w2,w3,w4,Id	Variable index=0		if(strlen(pathName)==0)		NewPath/O temporaryPath		PathName = "temporaryPath"	endif		do		fileName = IndexedFile($pathName, index,"TEXT")		if(strlen(fileName)==0)			break		endif		LoadVgIdData(fileName,pathName,index)|		if(strlen(S_waveNames)>0)|		endif		index +=1	while(1)		if(Exists("temporaryPath"))		KillPath temporaryPath	endifEndMacro Calcgm(id,gm)	String id,gm	Silent 1; PauseUpDate		Duplicate $id,$gm	Differentiate $gmEndMacro CalcAllgm()	Silent 1; PauseUpDate		String Id, gm	Variable index=0		do		Id = "Id"+num2istr(index)		gm="gm"+num2istr(index)		if(exists(Id)!=1)			break		endif		Calcgm(Id,gm)		index +=1	while(1)End		