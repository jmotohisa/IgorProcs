#pragma rtGlobals=1		// Use modern global access method.// MakeAnimation by J. Motohisa// macros to help create GIF animation and QuickTime Movie// ver 0.1 ?// ver 0.2 2006/06/27: updated and renamed to SavePICTforGIFAnimation2Dimg and MakeQTMovie2Dimg// Save to PICT filesMacro SavePICTforGIFAnimation2Dimg(thePath,prefix,zmin,zmax,size,ShowXYScale,ShowColorLegend)	String prefix,thePath = "data"	Variable zmin=-1,zmax=1,size=10,ShowXYScale=1,ShowColorLegend=2	Prompt thePath, "Name of path to save PICT files", popup PathList("*", ";", "")+"_New Path_"	Prompt prefix, "Prefix for wave names to show image"	Prompt zmin,"z-axis minimum"	Prompt zmax,"z-axis maximum"	Prompt size,"animation width (cm)"	Prompt ShowXYScale,"Show Scale of X and Y axes",popup,"yes;No"	Prompt ShowColorLegend,"Show Z-scale", popup,"yes;no"		Silent 1; PauseUpDate	Variable index = 0//	size = size*28.3//	String wname,wlist = wavelist("*",";","DIMS:2")	String wname,wlist = wavelist(prefix+"*",";","DIMS:2")	do		wname = GetStrFromList(wlist,index,";")//		print wname		if(strlen(wname)<1)			break		else			ShowImage(wname,"tempgraph",zmin,zmax,size,ShowXYScale)			SavePICT/O/P=$thePath as wname+".PICT"			DoWindow/K tempgraph			index +=1		endif	while(1)End MacroMacro MakeQTMovie2Dimg(thePath,MovieName,prefix,zmin,zmax,size,ShowXYScale,ShowColorLegend)	String thePath = "_New Path_",MovieName="newMov",prefix	Variable zmin=-1,zmax=1,size=10,ShowXYScale=1,ShowColorLegend=2	Prompt MovieName,"Movie Name"	Prompt thePath, "Name of path to save Movie files", popup PathList("*", ";", "")+"_New Path_"	Prompt prefix, "Prefix for wave names to show image"	Prompt zmin,"z-axis minimum"	Prompt zmax,"z-axis maximum"	Prompt size,"animation width (cm)"	Prompt ShowXYScale,"Show Scale of X and Y axes",popup,"yes;No"	Prompt ShowColorLegend,"Show Z-scale", popup,"yes;no"		Silent 1; PauseUpDate	Variable index = 0		if (CmpStr(thePath, "_New Path_") == 0)		// user selected new path ?		NewPath/O data			// this brings up dialog and creates or overwrites path		thePath = "data"	endif//	size = size*28.3	String wname,wlist = wavelist(prefix+"*",";","DIMS:2")//	NewMovie/O/P=$thePath as MovieName	do		wname = GetStrFromList(wlist,index,";")//		print wname		if(strlen(wname)<1)			break		endif		ShowImage(wname,"tempgraph",zmin,zmax,size,ShowXYScale)		if(index==0)			NewMovie/O/P=$thePath as MovieName		endif		DoWindow/F tempgraph		DoUpdate		AddMovieFrame//		SavePICT/O/P=$thePath as wname+".PICT"		DoWindow/K tempgraph		index +=1	while(1)	CloseMovie	PlayMovie/P=$thePath as MovieNameEnd MacroMacro ShowImage(wname,grname,zmin,zmax,size,ShowXYScale)	String wname,grname=""	Variable zmin=-1,zmax=1,size=10,ShowXYScale=1//,ShowColorLegend=2	Prompt wname,"wave name to display image",popup,wavelist("*",";","DIMS:2")	Prompt grname,"graph name"	Prompt zmin,"z-axis minimum"	Prompt zmax,"z-axis maximum"	Prompt size,"animation width (cm)"	Prompt ShowXYScale,"Show Scale of X and Y axes",popup,"yes;No"	PauseUpdate; Silent 1		size = size*28.3	Display;AppendImage $wname	if(strlen(grname)!=0)		DoWindow/C $(grname)	endif	ModifyGraph width=size,height={Aspect,1}	ModifyImage $wname ctab= {zmin,zmax,YellowHot,0}	if(ShowXYScale ==2)		ModifyGraph noLabel=2	endifEnd